plugins {
    id "groovy"
    id 'java'
    id 'application'
    id 'idea'
    id 'com.github.johnrengelman.shadow' version '1.2.4'
}

group 'us.cyrien.minecordbot'
version '2.0-SNAPSHOT'
mainClassName = 'us.cyrien.minecordbot.main.Minecordbot'

sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets {
    main {
        java {
            srcDirs = ['src']
        }
        resources {
            srcDir 'res'
        }
    }
}

repositories {
    mavenCentral()
    jcenter()
    mavenLocal()
    maven {
        url 'https://hub.spigotmc.org/nexus/content/groups/public/'
    }
    flatDir {
        dirs 'libs'
    }
}

dependencies {
    compile 'org.spigotmc:spigot-api:1.11.2-R0.1-SNAPSHOT'
    compile 'org.apache.commons:commons-lang3:3.5'
    compile 'org.apache.commons:commons-collections4:4.1'
    compile 'org.json:json:20160810'

    compile 'net.java.dev.jna:jna:4.2.2'

    compile 'com.neovisionaries:nv-websocket-client:1.30'
    compile('com.mashape.unirest:unirest-java:1.4.9') {
        exclude group: 'junit', module: 'junit'
    }
    compile 'net.dv8tion:JDA:3.0.0_160'
    compile name: 'Frame'
}

jar {
    baseName = project.name
    manifest {
        attributes 'Implementation-Version': version
        attributes 'Main-Class': mainClassName
    }
}

shadowJar {
    classifier = 'ALPHA'
    dependencies {
        exclude(dependency('org.spigotmc:spigot-api:1.11.2-R0.1-SNAPSHOT'))
        exclude(dependency('junit:junit:4.10'))
        exclude(dependency('javax.persistence:persistence-api:1.0'))
        exclude(dependency('com.google.guava:guava:18.0'))
        exclude(dependency('com.google.code.gson:gson:2.3.1'))
        exclude(dependency('com.googlecode.json-simple:json-simple:1.1.1'))
        exclude(dependency('org.avaje:ebean:2.8.1'))
        exclude(dependency('net.md-5:bungeecord-chat:1.10-SNAPSHOT'))
        exclude(dependency('org.hamcrest:hamcrest-core:1.1'))
        exclude(dependency('org.yaml:snakeyaml:1.17'))
    }
    relocate 'org.apache.commons.lang3', 'shadow.apache.org.commons.lang3'
}


build {
    dependsOn shadowJar
}


